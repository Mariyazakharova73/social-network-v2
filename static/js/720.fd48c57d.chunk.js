"use strict";(self.webpackChunksocial_network=self.webpackChunksocial_network||[]).push([[720],{5720:function(e,n,t){t.r(n),t.d(n,{default:function(){return ue}});var r=t(2791),s=t(9439),a=t(9900),i=t(5021),o=t(3366),u=t(7462),c=t(8182),l=t(4419),f=t(6199),d=t(6934),v=t(1402),m=t(5878),h=t(1217);function p(e){return(0,h.Z)("MuiListItemAvatar",e)}(0,m.Z)("MuiListItemAvatar",["root","alignItemsFlexStart"]);var g=t(184),x=["className"],Z=(0,d.ZP)("div",{name:"MuiListItemAvatar",slot:"Root",overridesResolver:function(e,n){var t=e.ownerState;return[n.root,"flex-start"===t.alignItems&&n.alignItemsFlexStart]}})((function(e){var n=e.ownerState;return(0,u.Z)({minWidth:56,flexShrink:0},"flex-start"===n.alignItems&&{marginTop:8})})),j=r.forwardRef((function(e,n){var t=(0,v.Z)({props:e,name:"MuiListItemAvatar"}),s=t.className,a=(0,o.Z)(t,x),i=r.useContext(f.Z),d=(0,u.Z)({},t,{alignItems:i.alignItems}),m=function(e){var n=e.alignItems,t=e.classes,r={root:["root","flex-start"===n&&"alignItemsFlexStart"]};return(0,l.Z)(r,p,t)}(d);return(0,g.jsx)(Z,(0,u.Z)({className:(0,c.Z)(m.root,s),ownerState:d,ref:n},a))})),w=t(3044),y=t(493),E=t(890),I=t(4721),S=t(8687),L=function(e){return e.chatReducer.status},k=function(e){return e.chatReducer.messages},F=r.memo((function(e){var n=e.message;return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)(i.ZP,{children:[(0,g.jsx)(j,{children:(0,g.jsx)(w.Z,{alt:n.userName,src:n.photo})}),(0,g.jsx)(a.Z,{primary:n.userName,secondary:(0,g.jsx)(g.Fragment,{children:(0,g.jsx)(E.Z,{component:"span",variant:"body2",color:"text.primary",children:n.message})})})]}),(0,g.jsx)(I.Z,{variant:"inset",component:"li"})]})})),R=function(){var e=(0,S.v9)(k),n=(0,r.useRef)(null),t=(0,r.useState)(!0),a=(0,s.Z)(t,2),i=a[0],o=a[1];return(0,r.useEffect)((function(){var e;i&&(null===(e=n.current)||void 0===e||e.scrollIntoView(!0))}),[e]),(0,g.jsx)("div",{style:{height:"400px",overflowY:"auto",marginBottom:"50px"},onScroll:function(e){var n=e.currentTarget;n.scrollHeight-n.scrollTop===n.clientHeight?!i&&o(!0):i&&o(!1)},children:(0,g.jsxs)(y.Z,{children:[e.map((function(e,n){return(0,g.jsx)(F,{message:e},n)})),(0,g.jsx)("div",{ref:n})]})})},b=t(6151),N=t(4554),A=t(1686),C=t(2506),M=t(7491),P=t(7460),T=t(4165),H=t(5861),_=t(700),B=t(3585),G={"messages-received":[],"status-changed":[]},J=null,O=function(){z("pending"),setTimeout(D,3e3)},V=function(e){var n=JSON.parse(e.data);G["messages-received"].forEach((function(e){return e(n)}))},W=function(){z("ready")},Y=function(){z("error"),console.error("REFRESH PAGE")},q=function(){var e,n,t,r;null===(e=J)||void 0===e||e.removeEventListener("close",O),null===(n=J)||void 0===n||n.removeEventListener("message",V),null===(t=J)||void 0===t||t.removeEventListener("open",W),null===(r=J)||void 0===r||r.removeEventListener("error",Y)},z=function(e){G["status-changed"].forEach((function(n){n(e)}))},D=function(){var e,n,t,r,s;q(),null===(e=J)||void 0===e||e.close(),J=new WebSocket(B.Lf),z("pending"),null===(n=J)||void 0===n||n.addEventListener("close",O),null===(t=J)||void 0===t||t.addEventListener("message",V),null===(r=J)||void 0===r||r.addEventListener("open",W),null===(s=J)||void 0===s||s.addEventListener("error",Y)},K=function(){D()},Q=function(){var e;G["messages-received"]=[],G["status-changed"]=[],q(),null===(e=J)||void 0===e||e.close()},U=function(e,n){return G[e].push(n),function(){G[e]=G[e].filter((function(e){return e!==n}))}},X=function(e,n){G[e]=G[e].filter((function(e){return e!==n}))},$=function(e){var n;null===(n=J)||void 0===n||n.send(e)},ee=null,ne=null,te=function(e){return null===ee&&(ee=function(n){e(se(n))}),ee},re=function(e){return null===ne&&(ne=function(n){e(ae(n))}),ne},se=function(e){return{type:_.j,payload:e}},ae=function(e){return{type:_._,payload:e}},ie=function(){var e=(0,S.I0)(),n=(0,S.v9)(L);return(0,g.jsx)(C.J9,{initialValues:{message:""},onSubmit:function(n,t){var r,s=t.resetForm;n.message&&(e((r=n.message,function(){var e=(0,H.Z)((0,T.Z)().mark((function e(n){return(0,T.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:$(r);case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}())),s())},validationSchema:M.Fh,validateOnBlur:!0,children:function(e){e.values,e.handleChange;var t=e.errors,r=e.touched,s=e.dirty;return(0,g.jsxs)(C.l0,{children:[(0,P.Gr)("message",null,r,t,"text","medium",!1,"Enter your message","filled",!0),(0,g.jsx)(N.Z,{mt:2,children:(0,g.jsx)(b.Z,{variant:"contained",type:"submit",endIcon:(0,g.jsx)(A.Z,{}),disabled:!s||!!t.message||"ready"!==n,children:"Send"})})]})}})},oe=function(){var e=(0,S.I0)(),n=(0,S.v9)(L);return(0,r.useEffect)((function(){return e(function(){var e=(0,H.Z)((0,T.Z)().mark((function e(n){return(0,T.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:K(),U("messages-received",te(n)),U("status-changed",re(n));case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()),function(){e(function(){var e=(0,H.Z)((0,T.Z)().mark((function e(n){return(0,T.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:X("messages-received",te(n)),X("status-changed",re(n)),Q();case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}())}}),[]),(0,g.jsxs)(g.Fragment,{children:["error"===n&&(0,g.jsx)("p",{children:"Some error occured. Please refresh the page"}),(0,g.jsx)(R,{}),(0,g.jsx)(ie,{})]})},ue=function(){return(0,g.jsx)(oe,{})}}}]);
//# sourceMappingURL=720.fd48c57d.chunk.js.map