"use strict";(self.webpackChunksocial_network=self.webpackChunksocial_network||[]).push([[4],{2004:function(e,n,t){t.r(n),t.d(n,{default:function(){return le}});var r=t(2791),s=t(9439),a=t(493),i=t(8687),o=function(e){return e.chatReducer.status},u=function(e){return e.chatReducer.messages},c=t(9900),l=t(5021),f=t(3366),d=t(7462),v=t(3733),m=t(4419),h=t(6199),p=t(6934),g=t(1402),x=t(5878),Z=t(1217);function j(e){return(0,Z.Z)("MuiListItemAvatar",e)}(0,x.Z)("MuiListItemAvatar",["root","alignItemsFlexStart"]);var w=t(184),y=["className"],I=(0,p.ZP)("div",{name:"MuiListItemAvatar",slot:"Root",overridesResolver:function(e,n){var t=e.ownerState;return[n.root,"flex-start"===t.alignItems&&n.alignItemsFlexStart]}})((function(e){var n=e.ownerState;return(0,d.Z)({minWidth:56,flexShrink:0},"flex-start"===n.alignItems&&{marginTop:8})})),E=r.forwardRef((function(e,n){var t=(0,g.Z)({props:e,name:"MuiListItemAvatar"}),s=t.className,a=(0,f.Z)(t,y),i=r.useContext(h.Z),o=(0,d.Z)({},t,{alignItems:i.alignItems}),u=function(e){var n=e.alignItems,t=e.classes,r={root:["root","flex-start"===n&&"alignItemsFlexStart"]};return(0,m.Z)(r,j,t)}(o);return(0,w.jsx)(I,(0,d.Z)({className:(0,v.Z)(u.root,s),ownerState:o,ref:n},a))})),S=t(3044),L=t(890),k=t(4721),F=r.memo((function(e){var n=e.message;return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)(l.ZP,{children:[(0,w.jsx)(E,{children:(0,w.jsx)(S.Z,{alt:n.userName,src:n.photo})}),(0,w.jsx)(c.Z,{primary:n.userName,secondary:(0,w.jsx)(w.Fragment,{children:(0,w.jsx)(L.Z,{component:"span",variant:"body2",color:"text.primary",children:n.message})})})]}),(0,w.jsx)(k.Z,{variant:"inset",component:"li"})]})})),b="ChatMessages_wrapper__w7ZjQ",R=function(){var e=(0,i.v9)(u),n=(0,r.useRef)(null),t=(0,r.useState)(!0),o=(0,s.Z)(t,2),c=o[0],l=o[1];return(0,r.useEffect)((function(){var e;c&&(null===(e=n.current)||void 0===e||e.scrollIntoView(!0))}),[e]),(0,w.jsx)("div",{className:b,onScroll:function(e){var n=e.currentTarget;n.scrollHeight-n.scrollTop===n.clientHeight?!c&&l(!0):c&&l(!1)},children:(0,w.jsxs)(a.Z,{children:[e.map((function(e,n){return(0,w.jsx)(F,{message:e},n)})),(0,w.jsx)("div",{ref:n})]})})},N=t(6151),M=t(4554),_=t(1686),A=t(2506),C=t(7491),G=t(7460),T=t(4165),H=t(5861),P=t(700),J=t(3585),O={"messages-received":[],"status-changed":[]},V=null,W=function(){z("pending"),setTimeout(D,3e3)},$=function(e){var n=JSON.parse(e.data);O["messages-received"].forEach((function(e){return e(n)}))},B=function(){z("ready")},Q=function(){z("error"),console.error("REFRESH PAGE")},q=function(){var e,n,t,r;null===(e=V)||void 0===e||e.removeEventListener("close",W),null===(n=V)||void 0===n||n.removeEventListener("message",$),null===(t=V)||void 0===t||t.removeEventListener("open",B),null===(r=V)||void 0===r||r.removeEventListener("error",Q)},z=function(e){O["status-changed"].forEach((function(n){n(e)}))},D=function(){var e,n,t,r,s;q(),null===(e=V)||void 0===e||e.close(),V=new WebSocket(J.Lf),z("pending"),null===(n=V)||void 0===n||n.addEventListener("close",W),null===(t=V)||void 0===t||t.addEventListener("message",$),null===(r=V)||void 0===r||r.addEventListener("open",B),null===(s=V)||void 0===s||s.addEventListener("error",Q)},K=function(){D()},U=function(){var e;O["messages-received"]=[],O["status-changed"]=[],q(),null===(e=V)||void 0===e||e.close()},X=function(e,n){return O[e].push(n),function(){O[e]=O[e].filter((function(e){return e!==n}))}},Y=function(e,n){O[e]=O[e].filter((function(e){return e!==n}))},ee=function(e){var n;null===(n=V)||void 0===n||n.send(e)},ne=null,te=null,re=function(e){return null===ne&&(ne=function(n){e(ae(n))}),ne},se=function(e){return null===te&&(te=function(n){e(ie(n))}),te},ae=function(e){return{type:P.j,payload:e}},ie=function(e){return{type:P._,payload:e}},oe=t(9230),ue=function(){var e=(0,oe.$G)().t,n=(0,i.I0)(),t=(0,i.v9)(o);return(0,w.jsx)(A.J9,{initialValues:{message:""},onSubmit:function(e,t){var r,s=t.resetForm;e.message&&(n((r=e.message,function(){var e=(0,H.Z)((0,T.Z)().mark((function e(n){return(0,T.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:ee(r);case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}())),s())},validationSchema:C.Fh,validateOnBlur:!0,children:function(n){n.values,n.handleChange;var r=n.errors,s=n.touched,a=n.dirty;return(0,w.jsxs)(A.l0,{children:[(0,G.Gr)("message",e("chatMessage"),s,r,e),(0,w.jsx)(M.Z,{mt:2,children:(0,w.jsx)(N.Z,{variant:"contained",type:"submit",endIcon:(0,w.jsx)(_.Z,{}),disabled:!a||!!r.message||"ready"!==t,children:e("buttonSend")})})]})}})},ce=function(){var e=(0,oe.$G)().t,n=(0,i.I0)(),t=(0,i.v9)(o);return(0,r.useEffect)((function(){return n(function(){var e=(0,H.Z)((0,T.Z)().mark((function e(n){return(0,T.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:K(),X("messages-received",re(n)),X("status-changed",se(n));case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()),function(){n(function(){var e=(0,H.Z)((0,T.Z)().mark((function e(n){return(0,T.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Y("messages-received",re(n)),Y("status-changed",se(n)),U();case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}())}}),[]),(0,w.jsxs)(w.Fragment,{children:["error"===t&&(0,w.jsx)("p",{children:e("error")}),(0,w.jsx)(R,{}),(0,w.jsx)(ue,{})]})},le=function(){return(0,w.jsx)("div",{style:{height:"100vh"},children:(0,w.jsx)(ce,{})})}}}]);
//# sourceMappingURL=4.ffb802ca.chunk.js.map